#! /bin/sh

# usage: STUBS_config <repository> [cl7211 | cl7111]

if [ "$2"x = "x" ]; then
  CL7x11="cl7211"
else
  CL7x11=$2
fi

tcl $1/pkgconf.tcl                                              \
  --target=arm --platform=${CL7x11} --startup=stubs             \
  --disable CYGPKG_KERNEL --disable CYGPKG_UITRON               \
  --disable CYGPKG_LIBC --disable CYGPKG_LIBM                   \
  --disable CYGPKG_ERROR --disable CYGPKG_IO                    \
  --disable CYGPKG_IO_SERIAL --disable CYGPKG_DEVICES_WALLCLOCK \
  --disable CYGPKG_DEVICES_WATCHDOG

patch <<END_OF_PATCH -p0
--- pkgconf/hal.h~      Thu Jul  8 08:26:44 1999
+++ pkgconf/hal.h       Wed Jul 28 10:51:07 1999
@@ -369,10 +369,10 @@
 
    }}CFG_DATA */
 
-#undef   CYGDBG_HAL_DEBUG_GDB_INCLUDE_STUBS
+#define  CYGDBG_HAL_DEBUG_GDB_INCLUDE_STUBS
 #undef   CYGDBG_HAL_DEBUG_GDB_BREAK_SUPPORT
-#define  CYGDBG_HAL_DEBUG_GDB_CTRLC_SUPPORT
-#define  CYGDBG_HAL_DEBUG_GDB_THREAD_SUPPORT
+#undef   CYGDBG_HAL_DEBUG_GDB_CTRLC_SUPPORT
+#undef   CYGDBG_HAL_DEBUG_GDB_THREAD_SUPPORT
 
 /*
  * NOTE:
END_OF_PATCH
